<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NBA Predictor</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="../static/css/mystyle.css">

</head>
<body>
    <div class="title">
        <h1>NBA Predictor</h1> 
    </div>
    
    <div class="container" width="">

                <div class="sidenav">
                    <a href="#introduction">Introduction</a>
                    <a href="#prediction">Predictions</a>
                    <a href="#visuals">Historical Data</a>
                    <a href="#source">Source Data</a>
                    <a href="#ml-model">Machine Learning Model</a>
                </div>

            <div class="container">
                <div class="row">
                    <h2 id="introduction" style="padding-bottom: 30px">
                        Introduction
                    </h2>
                    <h4 style="padding-bottom: 20px">
                        Using machine learning, can a winner be predicted in the NBA? 
                    </h4>
                    <p style="text-align: left">
                        Many sport betting apps give you options to bet on who wins, which player scores what, how many points there will be in a game etc..
                        These events are typically seen as being random, but is that really true? Are there in fact trends or factors that contribute to game outcomes? 
                        Sports tend to have a large variety of statistics and data, the results are typically defined by the winner or loser. This makes for the perfect dataset to use a machine learning model. <br>
                        <br>
                        *It may be difficult to use this research to make money off of sports betting however because:
                    </p>
                        <ul style="text-align: left; padding-left: 75px;">
                        <li>The odds are set in betting app’s favor, “The house always wins”</li>
                        <li>Our model isn't perfect as is based on historical data</li>
                        <li>The human element of the game, from both players and referees </li>
                        </ul>
                    <p style="text-align: left">


                    </p>
                </div>

                <div class="row" style="padding-bottom: 180px">
                    <h2 id="prediction" style="padding-bottom: 60px">
                        Predictions
                    </h2>
                    
                    <div>
                        <a class="button" href="/prediction_teams">Total Wins & Playoffs Predictor</a>
                        <a class="button" href="/prediction_players">Player Total Score Predictor</a>
                    </div>
                </div>

                <div class="row">
                    <h2 id="visuals">
                        Historical Data
                    </h2>
                    <div class='tableauPlaceholder' id='viz1652823119737' style='position: relative; padding-left: 50px;'>
                        <noscript><a href='#'>
                        <img alt='Story 1 ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NB&#47;NBAtests&#47;Story1&#47;1_rss.png' style='border: none' /></a>
                        </noscript>
                        <object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> 
                            <param name='embed_code_version' value='3' /> <param name='site_root' value='' />
                            <param name='name' value='NBAtests&#47;Story1' /><param name='tabs' value='no' />
                            <param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;NB&#47;NBAtests&#47;Story1&#47;1.png' />
                            <param name='animate_transition' value='yes' />
                            <param name='display_static_image' value='yes' />
                            <param name='display_spinner' value='yes' />
                            <param name='display_overlay' value='yes' />
                            <param name='display_count' value='yes' />
                            <param name='language' value='en-US' />
                        </object>
                    </div>    
                    <script type='text/javascript'>
                        var divElement = document.getElementById('viz1652823119737');
                        var vizElement = divElement.getElementsByTagName('object')[0];
                        vizElement.style.minWidth='750px';
                        vizElement.style.maxWidth='1050px';
                        vizElement.style.width='100%';
                        vizElement.style.minHeight='819px';
                        vizElement.style.maxHeight='1119px';
                        vizElement.style.height=(divElement.offsetWidth*0.75)+'px';
                        var scriptElement = document.createElement('script');
                        scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';
                        vizElement.parentNode.insertBefore(scriptElement, vizElement);
                    </script>
                </div>

                <div class="row">
                    <h2 id="source" style="padding-bottom: 20px; padding-top: 80px;">
                        Source Data
                    </h2>

                    <a href='https://www.kaggle.com/datasets/nathanlauga/nba-games'>Kaggle: NBA Games</a>
                    <a href='https://www.kaggle.com/datasets/wyattowalsh/basketball'>Kaggle: NPA Player Attributes</a>
                    
                    <p style="text-align: left; padding-top: 40px;">
                        The majority of our data was sourced from the csv files, as they contained fairly complete (and recent) sets of general NBA data, such as game and player statistics for all seasons
                        dating back to 2003-04. We started by cleaning up those csv files and running preliminary analyses through a machine learning model. Upon initial review, we thought that we might
                        benefit from adding more features to see if we could boost our model accuracy.<br>
                        <br>
                        In addition to the Kaggle data, ESPN.com has a well-organized page containing attendance data for all NBA seasons included in our other datasets, so we decided to scrape from their
                        website and use that data in our game-based predictions. The data we retrieved included total yearly attendance, as well as home and away attendance averages for each team. After
                        scraping the attendance data, we were satisfied with the features we had in our datasets.<br>
                        <br>
                        Next, we dropped unnecessary columns and began to sort and merge the data according to the predictions we wanted to make. The game data was sorted by season and was
                        also separated according to playoff games versus regular season games. We did the same with the player data, thus creating playoff and regular season tables for both of our
                        prediction categories (team-specific and player-specific). We waited to merge in the additional data until after all of the sorting, as the attendance data was already seasonally
                        separated and the player attributes data is static. With our data compilation completed, we exported it to csv files to be used in our machine learning models.<br>
                    </p>

                </div>

                <div class="row">
                    <h2 id="ml-model" style="padding-bottom: 40px; padding-top: 60px;">
                        Machine Learning Model
                    </h2>
                    
                    <p style="text-align: left;">
                        The model building process began with using the csv files exported by the sql databases. <br>
                        The first part was creating a usable dataframe: <br>
                        <br>
                        <img src="https://user-images.githubusercontent.com/71575748/169663523-f76f4c55-050d-4d41-a691-5b72f3042aa6.png"><br>
                        <br>
                        This was made from using groupme to merge the rows into averages for each season based on the team groups.<br>
                        The process goes as follows:
                    </p>

                    <ul style="text-align: left; padding-left: 75px;">
                        <li>The use of the loc function was used to breakdown each season into its own dataframe and fed into a list of dataframes.</li>
                        <li>Each dataframe was fed through a function tasked with processing them to aquire season averages for features such as 2 or 3 pointer shot averages to average number of rebounds or assists throughout the season.</li>
                        <li>A sum of games won was also made from the different frames however this is going to be the target for the linear regression model and the OLS model</li>
                        <li>The function split the games into home and away games using the data to accumulate data for everygame throughout the season.</li>
                        <li>After getting the dataframes processed they were merged into a unified dataframe broken up by each season.</li>
                        <li>A dataframe was made from a csv file containing the seasonal attendance of each season for the teams.</li>
                        <li>The 2 frames were organized by team and year so they would align allowing for an easy merge into a unified dataframe.</li>
                    </ul>   

                    <h4 style="text-align: left; padding-top: 20px;">
                        Linear Regression:
                    </h4>
                        
                    <p style="text-align: left;">
                        The dataframes were fed into a linear regression model and OLS model to predict the number of wins a team would get per season:<br>
                        <br>
                        <img src="https://user-images.githubusercontent.com/71575748/169635542-7759190c-11d1-4faf-b3fa-5ee74017aadf.png"><br>
                    </p>

                    <ul style="text-align: left; padding-left: 75px;">
                        <li>The OLS model showed more promise with a higher amount of error it could explain.</li>
                        <li>Due to the overlining of metrics such as the average accuracy of 3 pointers and 2 pointers the model has issues with multicolinearity</li>
                        <li>This is because a team that can hit 3s consitantly will be able to hit 2s and field goals often.</li>
                        <li>Notably, having the assist variable causes a decrease in win estimations.</li>
                    </ul>

                    <h4 style="text-align: left; padding-top: 20px;">
                    Classification Model - Predicting Playoff Makers:
                    </h4>

                    <p style="text-align: left;">
                        The dataframe used for the linear regression model was saved and loaded again here.
                        Using the playoffs data the year was taken and decreased by 1 to get the proper season.
                        A string version of the date and team names were merged in both dataframes to see what teams were in the playoffs in each year.
                        A variable for playoffs was made and filled with 0s as a default.
                        Using the 'if in' test, we were able to check which teams made the playoffs for what years using the combined columns as so.<br>
                        <br>
                        <img src="https://user-images.githubusercontent.com/71575748/169663581-d54a75fc-ba56-4176-bf8e-190044e07ca3.png"><br>
                        <br>
                        If the team and year combination existed in the playoff dataset the playoffs column would be fill with a 1 for that index.
                        This creates our target variable to check if the team made the playoffs for that particular season
                        The data was split into training and testing sets.
                        Using classes and functions, the process of fitting the model and getting the accuracy, recall, and precision scores.
                        This culminated into a dataframe sorted by accuracy scores. 
                        Accuracy is being used because there is not really a score more important to target like precision or recall.<br>
                        <br>
                        <img src="https://user-images.githubusercontent.com/71575748/169663640-073727c1-df70-4b68-aa81-f4e477d5e40d.png">
                    </p>   

                    <ul style="text-align: left; padding-left: 75px;">
                        <li>Best model is the Logistic Regression Classifier model</li>
                        <li>Second best model is the Random Forest Classifier model</li>
                        <li>Third best model is the Tuned Bagging Classifier model</li>
                    </ul>
                    
                </div>

            </div>
        
    </div>
    <div class="footnotes">
        <p style="font-size: 20px; color: white;">
            Link to our Github page:<br>
        <a href="https://github.com/alexlieberman22/Final-Project-NBA-Predictions" style="font-size: 20px;"">Final-Project-NBA-Predictions</a><br>    
        </p><br>
        <p style="color: white;">
            Creators: &nbsp; Alex Lieberman, Kevin Flores, Eduardo Perez, Marcos Galarza
        </p>
        <a href="https://images.fineartamerica.com/images/artworkimages/mediumlarge/2/basketball-art-print-swoosh-vs-22-takumi-park.jpg">Basketball ball artwork created by takumi park - fineartamerica</a>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.5.0/d3.js"></script>
</body>

</html>